{"version":3,"sources":["pages/balance/index.js"],"names":["index","Component","constructor","props","super","getBalance","a","API","result","console","log","setState","balance","handleInput","event","value","target","test","replace","parseFloat","this","extractNum","submitForm","alertTips","state","alertStatus","componentDidMount","shouldComponentUpdate","nextProps","nextState","is","fromJS","render","className","headerTitle","record","type","onChange","placeholder","maxLength","text","clickCallBack","alertContent","onClose"],"mappings":"4RAce,MAAMA,UAAcC,YACjCC,YAAYC,GAAQ,IAAD,EACjBC,MAAMD,GADW,YAgEnBE,WAhEmB,sBAgEN,4BAAAC,EAAA,+EAEUC,IAAIF,aAFd,OAELG,EAFK,OAGTC,QAAQC,IAAIF,GACZ,EAAKG,SAAS,CAAEC,QAASJ,IAJhB,yGAhEM,KA4EnBK,YAAeC,IACb,IAAIC,EAAQD,EAAME,OAAOD,MACrB,sBAAsBE,KAAKF,KACzB,YAAYE,KAAKF,KACnBA,EAAQA,EAAMG,QAAQ,MAAO,KAE3B,UAAUD,KAAKF,KACjBA,EAAQA,EAAMG,QAAQ,MAAO,MAE/BH,EAAQA,EAAMG,QAAQ,QAAS,MAC3BC,WAAWJ,GAAS,MACtBA,EAAQ,UAEVK,KAAKT,SAAS,CAAEU,WAAYN,MAzFb,KA6FnBO,WAAa,KACX,IAAIC,EAAY,GACZF,EAAaD,KAAKI,MAAMH,WACvBD,KAAKI,MAAMH,WAGdF,WAAWC,KAAKI,MAAMH,YAAcF,WAAWC,KAAKI,MAAMZ,QAAQA,SAElEW,EAAY,gEAEZA,EAAY,6CACZF,EAAa,IAPbE,EAAY,6CAUdH,KAAKT,SAAS,CACZc,aAAa,EACbF,YACAF,gBA3GFD,KAAKI,MAAQ,CACXD,UAAW,GACXE,aAAa,EACbJ,WAAY,GACZT,QAAS,CACPA,QAAS,IAKfc,oBACEN,KAAKf,aAGPsB,sBAAsBC,EAAWC,GAC/B,OACGC,YAAGC,YAAOH,GAAYG,YAAOX,KAAKjB,UAClC2B,YAAGC,YAAOF,GAAYE,YAAOX,KAAKI,QAGvCQ,SACE,OACE,yBAAKC,UAAU,qBACb,kBAAC,IAAD,CAAQC,YAAY,eAAKC,QAAM,IAC/B,6BAASF,UAAU,mBACjB,uBAAGA,UAAU,yBAAb,yDACYb,KAAKI,MAAMZ,QAAQA,SAE/B,0BAAMqB,UAAU,wBACd,2FACA,2BACE,wCACA,2BACEG,KAAK,OACLrB,MAAOK,KAAKI,MAAMH,WAClBgB,SAAUjB,KAAKP,YACfyB,YAAY,OACZC,UAAU,QAIhB,kBAAC,IAAD,CACEN,UAAU,aACVO,KAAK,2BACLC,cAAerB,KAAKE,cAGxB,kBAAC,IAAD,CACEoB,aAActB,KAAKI,MAAMD,UACzBE,YAAaL,KAAKI,MAAMC,YACxBkB,QAAS,KACPvB,KAAKT,SAAS,CACZc,aAAa,EACbF,UAAW","file":"static/js/4.5a88d144.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { is, fromJS } from \"immutable\";\r\n\r\nimport API from \"../../api/api\";\r\n\r\n//弹窗组件\r\nimport Alert from \"../../components/alert\";\r\n//头部组件\r\nimport Header from \"../../components/header\";\r\n//按钮组件\r\nimport TouchableOpacity from \"../../components/TouchableOpacity\";\r\n\r\nimport \"./index.less\";\r\n\r\nexport default class index extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      alertTips: \"\", //弹窗文字\r\n      alertStatus: false, //弹窗状态\r\n      extractNum: \"\", //提现输入金额\r\n      balance: {\r\n        balance: 0,\r\n      },\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBalance();\r\n  }\r\n  //props、state改变了就渲染组件\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    return (\r\n      !is(fromJS(nextProps), fromJS(this.props)) ||\r\n      !is(fromJS(nextState), fromJS(this.state))\r\n    );\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"balance-container\">\r\n        <Header headerTitle=\"提现\" record />\r\n        <section className=\"balance-content\">\r\n          <p className=\"balance-content-title\">\r\n            您当前可提现金额为{this.state.balance.balance}\r\n          </p>\r\n          <form className=\"balance-content-form\">\r\n            <p>请输入提现金额（元）</p>\r\n            <p>\r\n              <span>￥</span>\r\n              <input\r\n                type=\"text\"\r\n                value={this.state.extractNum}\r\n                onChange={this.handleInput}\r\n                placeholder=\"0.00\"\r\n                maxLength=\"5\"\r\n              />\r\n            </p>\r\n          </form>\r\n          <TouchableOpacity\r\n            className=\"submit-btn\"\r\n            text=\"马上提现\"\r\n            clickCallBack={this.submitForm}\r\n          />\r\n        </section>\r\n        <Alert\r\n          alertContent={this.state.alertTips}\r\n          alertStatus={this.state.alertStatus}\r\n          onClose={() => {\r\n            this.setState({\r\n              alertStatus: false,\r\n              alertTips: \"\",\r\n            });\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getBalance = async () => {\r\n    try {\r\n      let result = await API.getBalance();\r\n      console.log(result);\r\n      this.setState({ balance: result });\r\n    } catch (error) {}\r\n  };\r\n  /**\r\n   * 格式化输入数据\r\n   * 格式为微信红包格式：最大 200.00\r\n   * @param  {object} event 事件对象\r\n   */\r\n  handleInput = (event) => {\r\n    let value = event.target.value;\r\n    if (/^\\d*?\\.?\\d{0,2}?$/gi.test(value)) {\r\n      if (/^0+[1-9]+/.test(value)) {\r\n        value = value.replace(/^0+/, \"\");\r\n      }\r\n      if (/^0{2}\\./.test(value)) {\r\n        value = value.replace(/^0+/, \"0\");\r\n      }\r\n      value = value.replace(/^\\./gi, \"0.\");\r\n      if (parseFloat(value) > 200) {\r\n        value = \"200.00\";\r\n      }\r\n      this.setState({ extractNum: value });\r\n    }\r\n  };\r\n\r\n  submitForm = () => {\r\n    let alertTips = \"\";\r\n    let extractNum = this.state.extractNum;\r\n    if (!this.state.extractNum) {\r\n      alertTips = \"请输入提现金额\";\r\n    } else if (\r\n      parseFloat(this.state.extractNum) > parseFloat(this.state.balance.balance)\r\n    ) {\r\n      alertTips = \"提现金额不能大于余额\";\r\n    } else {\r\n      alertTips = \"申请已成功提交\";\r\n      extractNum = \"\";\r\n    }\r\n\r\n    this.setState({\r\n      alertStatus: true,\r\n      alertTips,\r\n      extractNum,\r\n    });\r\n  };\r\n}\r\n"],"sourceRoot":""}