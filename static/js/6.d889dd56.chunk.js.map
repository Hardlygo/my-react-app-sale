{"version":3,"sources":["pages/production/index.js"],"names":["Production","Component","componentDidMount","this","props","proData","dataList","length","getProData","shouldComponentUpdate","nextProps","nextState","is","fromJS","state","render","className","headerTitle","confirm","isFetching","map","item","index","key","onClick","selectPro","selectStatus","product_name","selectNum","handleEdit","bind","toggleSelect","num","currentNum","editPro","connect","dispatch"],"mappings":"oJAAA,2GAaO,MAAMA,UAAmBC,YAQ9BC,oBACOC,KAAKC,MAAMC,QAAQC,SAASC,QAC/BJ,KAAKC,MAAMI,aAIfC,sBAAsBC,EAAWC,GAC/B,OACGC,YAAGC,YAAOV,KAAKC,OAAQS,YAAOH,MAC9BE,YAAGC,YAAOV,KAAKW,OAAQD,YAAOF,IAGnCI,SACE,OACE,0BAAMC,UAAU,iBACd,kBAAC,IAAD,CAAQC,YAAY,2BAAOC,SAAO,IAClC,6BAASF,UAAU,gBAChBb,KAAKC,MAAMC,QAAQc,WACnB,yBAAKH,UAAU,eAAf,sCAEC,wBAAIA,UAAU,eACXb,KAAKC,MAAMC,QAAQC,SAASc,IAAI,CAACC,EAAMC,IAEpC,wBAAIC,IAAKD,EAAON,UAAU,YACxB,yBACEA,UAAU,kBACVQ,QAAS,KACPrB,KAAKC,MAAMqB,UAAUH,KAGvB,0BACEN,UAAS,yCACPK,EAAKK,aAAe,eAAiB,MAGzC,0BAAMV,UAAU,YAAYK,EAAKM,eAEnC,yBAAKX,UAAU,iBACb,0BACEA,UAAS,oBACPK,EAAKO,UAAY,EAAI,cAAgB,IAEvCJ,QAASrB,KAAK0B,WAAWC,KAAK3B,KAAMmB,GAAQ,KAE9C,0BAAMN,UAAU,WAAWK,EAAKO,WAChC,0BACEZ,UAAS,WACTQ,QAASrB,KAAK0B,WAAWC,KAAK3B,KAAMmB,EAAO,WAajES,aAAaT,GACXnB,KAAKC,MAAMqB,UAAUH,GAOvBO,WAAWP,EAAOU,GAChB,IAAIC,EAAa9B,KAAKC,MAAMC,QAAQC,SAASgB,GAAOM,UAAYI,EAC5DC,EAAa,GACjB9B,KAAKC,MAAM8B,QAAQZ,EAAOW,IAcfE,sBAVUrB,IAAD,CACtBT,QAASS,EAAMT,UAGW+B,IAAD,CACzB5B,WAAY,IAAM4B,EAAS5B,eAC3BiB,UAAYH,GAAUc,EAASX,YAAUH,IACzCY,QAAS,CAACZ,EAAOM,IAAcQ,EAASF,YAAQZ,EAAOM,MAG1CO,CAA6CnC","file":"static/js/6.d889dd56.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { is, fromJS } from \"immutable\";\r\n//action\r\nimport { getProData, selectPro, editPro } from \"../../store/production/action\";\r\n\r\n//头部组件\r\nimport Header from \"../../components/header\";\r\n\r\nimport \"./index.less\";\r\n\r\nexport class Production extends Component {\r\n  static propTypes = {\r\n    proData: PropTypes.object.isRequired,\r\n    getProData: PropTypes.func.isRequired,\r\n    selectPro: PropTypes.func.isRequired,\r\n    editPro: PropTypes.func.isRequired,\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (!this.props.proData.dataList.length) {\r\n      this.props.getProData();\r\n    }\r\n  }\r\n  //重现渲染条件\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    return (\r\n      !is(fromJS(this.props), fromJS(nextProps)) ||\r\n      !is(fromJS(this.state), fromJS(nextState))\r\n    );\r\n  }\r\n  render() {\r\n    return (\r\n      <main className=\"pro-container\">\r\n        <Header headerTitle=\"选择产品\" confirm />\r\n        <section className=\"pro-list-con\">\r\n          {this.props.proData.isFetching ? (\r\n           <div className=\"loading-tip\"> 正在加载中...</div>\r\n          ) : (\r\n            <ul className=\"pro-list-ul\">\r\n              {this.props.proData.dataList.map((item, index) => {\r\n                return (\r\n                  <li key={index} className=\"pro-item\">\r\n                    <div\r\n                      className=\"pro-item-select\"\r\n                      onClick={() => {\r\n                        this.props.selectPro(index);\r\n                      }}\r\n                    >\r\n                      <span\r\n                        className={`icon-xuanze1 pro-select-status ${\r\n                          item.selectStatus ? \"pro-selected\" : \"\"\r\n                        }`}\r\n                      ></span>\r\n                      <span className=\"pro-name\">{item.product_name}</span>\r\n                    </div>\r\n                    <div className=\"pro-item-edit\">\r\n                      <span\r\n                        className={`icon-jian ${\r\n                          item.selectNum > 0 ? \"edit-active\" : \"\"\r\n                        }`}\r\n                        onClick={this.handleEdit.bind(this, index, -1)}\r\n                      ></span>\r\n                      <span className=\"pro-num\">{item.selectNum}</span>\r\n                      <span\r\n                        className={`icon-jia`}\r\n                        onClick={this.handleEdit.bind(this, index, 1)}\r\n                      ></span>\r\n                    </div>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          )}\r\n        </section>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  toggleSelect(index) {\r\n    this.props.selectPro(index);\r\n  }\r\n  /**\r\n   * 添加或删减商品，交由redux进行数据处理，作为全局变量\r\n   * @param  {int} index 编辑的商品索引\r\n   * @param  {int} num   添加||删减的商品数量\r\n   */\r\n  handleEdit(index, num) {\r\n    let currentNum = this.props.proData.dataList[index].selectNum + num;\r\n    if (currentNum < 0) return;\r\n    this.props.editPro(index, currentNum);\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  proData: state.proData,\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  getProData: () => dispatch(getProData()),\r\n  selectPro: (index) => dispatch(selectPro(index)),\r\n  editPro: (index, selectNum) => dispatch(editPro(index, selectNum)),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Production);\r\n"],"sourceRoot":""}